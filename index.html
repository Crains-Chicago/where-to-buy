---
layout: base
---

<div class="row">
  <div class="col-xs-12">
    <h1 class="title">
      <i class="fa fa-lg fa-home"></i> Where to Buy
      <small>Find the right Chicagoland real estate for you.</small>
    </h1>
    <hr />
  </div>
</div>

<div class="row">
  <div class="col-sm-10 col-sm-offset-1">
    <h3>I am...</h3>
    <div class="carousel">
      <div class="carousel-cell text-center" id="suburban-home">
        <span class="carousel-title">Suburban family</span>
      </div>
      <div class="carousel-cell text-center" id="city-home">
        <span class="carousel-title">City family</span>
      </div>
      <div class="carousel-cell text-center" id="downsized-home">
        <span class="carousel-title">Empty-nesters</span>
      </div>
      <div class="carousel-cell text-center" id="in-town">
        <span class="carousel-title">Weekenders</span>
      </div>
      <div class="carousel-cell text-center" id="vacation-home">
        <span class="carousel-title">Vacationers</span>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-4">
    <div class="text-center">
      <h3>My priorities</h3>
      <p class="small help-block">Drag to change</p>
    </div>
    <div class="well" style="height:350px;">
      <div class="grid">
        <div class="grid-item text-center" id="diversity"><span class="badge pull-left"></span> High Diversity</div>
        <div class="grid-item text-center" id="schools"><span class="badge pull-left"></span> Good Schools</div>
        <div class="grid-item text-center" id="crime"><span class="badge pull-left"></span> Low Crime</div>
        <div class="grid-item text-center" id="price"><span class="badge pull-left"></span> Solid Price Growth</div>
        <div class="grid-item text-center" id="commute"><span class="badge pull-left"></span> Short Commutes</div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="text-center">
      <form>
        <div class="form-group">
          <div class="col-xs-12">
            <div class="input-group" style="margin-top:10px">
              <input class="form-control input-lg search-text" id="search-address" placeholder="Set your work address (optional)" type="text" style="width:100%" />
              <div class="input-group-btn">
                <input class="btn btn-primary btn-lg" id="search-button" type="button" value="Search" />
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
    <div id="map"></div>
  </div>
  <div class="col-md-4">
    <div class="text-center">
      <h3>Best communities</h3>
      <p class="small help-block">Click to see more information</p>
    </div>
    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover" id="best-communities">
        <tbody>
          <tr>
            <td class="ranking">1. <span id="rank-1"></span></td>
          </tr>
          <tr>
            <td class="ranking">2. <span id="rank-2"></span></td>
          </tr>
          <tr>
            <td class="ranking">3. <span id="rank-3"></span></td>
          </tr>
          <tr>
            <td class="ranking">4. <span id="rank-4"></span></td>
          </tr>
          <tr>
            <td class="ranking">5. <span id="rank-5"></span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Community information modal -->
<div class="modal fade" id="community-info" tabindex="-1" role="dialog" aria-labelledby="community-info-label"aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h2 class="modal-title" id="community-info-label">Community Information</h2>
      </div>
      <div class="modal-body">
        <div class="container-fluid">
          <div id="property-info"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="assets/js/leaflet.js"></script>
<script src="assets/js/leaflet-google.js"></script>
<script src="assets/js/tether.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/draggabilly.pkgd.min.js"></script>
<script src="assets/js/packery.pkgd.min.js"></script>
<script src="assets/js/flickity.pkgd.min.js"></script>
<script src="assets/js/jquery.csv.min.js"></script>
<script src="assets/js/wheretobuy.js"></script>
<script>

  $(function() {
      // Initialize map and other goodies
      WhereToBuy.initialize();

      // Get the profile and priority widgets going
      var $carousel = $('.carousel').flickity();
      var $grid = $('.grid').packery({
          isInitLayout: false,
          percentPosition: true,
          itemSelector: '.grid-item',
          gutter: 10,
      });

      // Allow user to drag around priorities
      $('.grid-item').each(function(i, gridItem) {
          var drag = new Draggabilly(gridItem);
          $grid.packery('bindDraggabillyEvents', drag);
      });

      // Show priority order after layout
      function rankPriorities() {
        var items = $grid.packery('getItemElements');
        $(items).each(function(i, item) {
            $(item).removeClass('rank-1 rank-2 rank-3 rank-4 rank-5').addClass('rank-' + (i+1).toString());
            $(item).find('span').html(i+1);
        });
      }

      // Init priority order
      $grid.on('layoutComplete', rankPriorities);

      // When priorities get reordered, recalculate top communities
      $grid.on('dragItemPositioned', function() {
          rankPriorities();
          WhereToBuy.displayRanking(WhereToBuy.randomCommunities());
      });

      $grid.on('profileSelected', function() {
          WhereToBuy.displayRanking(WhereToBuy.randomCommunities());
      })

      // Trigger initial priority layout
      $grid.packery();

      // Define UX for the community rankings
      $('.ranking').on('click', function() {
          WhereToBuy.selectCommunity($(this).children('span').text());
      });

      // Init search address
      var autocomplete = new google.maps.places.Autocomplete(document.getElementById('search-address'));

      // Bind click and return events for the search bar
      $('#search-button').on('click', WhereToBuy.addressSearch);
      $('body').on('keypress', '#search-address', function(e) {
          if (e.keyCode == 13) {
              e.preventDefault();
              $('#search-button').click();
          }
      });

      // Bind click and return events for the profile carousel
      $('.carousel-cell').on('click', WhereToBuy.viewProfile);
  });

</script>